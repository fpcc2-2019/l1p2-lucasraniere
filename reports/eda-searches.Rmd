---
title: "EDA buscas"
output:
  html_document:
    df_print: paged
---

O objeto principal da análise são as buscas e a navegação depois da busca. Criamos esses dados a partir dos dados originais da wikimedia em `/data/search_data.csv`. 

Aqui, exploramos esses dados. 

```{r setup, echo=FALSE, warning=FALSE}
library(tidyverse)
library(here)
library(lubridate)
theme_set(theme_bw())
```

```{r ETL, echo=FALSE, warning=FALSE}
buscas = read_csv(here::here("data/search_data.csv"))
```

```{r echo=FALSE, warning=FALSE}
buscas %>% 
    ggplot(aes(x = results)) + 
    geom_histogram(binwidth = 5) 
```

## 1.What is our daily overall clickthrough rate? How does it vary between the groups?

```{r echo=FALSE, warning=FALSE}
buscas
```

## 2.Which results do people tend to try first? How does it change day-to-day?

```{r}
# first_click

buscas %>%
    filter(!is.na(first_click)) %>%
    ggplot(aes(x = session_id, y = first_click)) +
    geom_point()
```

```{r}
buscas %>%
    filter(!is.na(first_click)) %>%
    select(session_id, search_index, first_click) %>%
    arrange(desc(first_click))
```

Aqui podemos ver alguns valores atípicos, onde os resultados acessados estão em uma posição muito alta. Onde até o resultado de 4103 foi clicado.

```{r}
buscas %>%
    filter(!is.na(first_click), first_click > 299) %>%
    count()
```

```{r}
buscas %>%
    filter(!is.na(first_click), first_click < 300) %>%
    count()
```

Temos 33 valores com cliques acima da posição 300, e 33161 com cliques abaixo da posição de 300. Para uma melhor visualização iremos utilizar os valores com posição abaixo de 300.

```{r}
buscas %>%
    filter(!is.na(first_click), first_click < 300) %>%
    ggplot(aes(x = session_id, y = first_click)) +
    geom_point()
```


## 3.What is our daily overall zero results rate? How does it vary between the groups?

```{r}
buscas %>%
    filter(results == 0)
```


## 4.Let session length be approximately the time between the first event and the last event in a session. Choose a variable from the dataset and describe its relationship to session length. 

relacionar o tempo da sessão com número de clicks

lembrar de ordenar
```{r}
buscas %>%
    filter(!is.na(session_length), !is.na(session_id), !is.na(num_clicks)) %>%
    ggplot(aes(x = num_clicks, y = session_length/60)) +
    geom_point()
    
```

